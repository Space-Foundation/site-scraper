<!DOCTYPE html>
<html>
  <head>
    <title>Web Scraper</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
    <style>
      .loader {
        border: 8px solid #f3f3f3; /* Light grey */
        border-top: 8px solid #3498db; /* Blue */
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 1s linear infinite;
        display: none; /* Hidden by default */
        position: fixed; /* Use fixed or absolute positioning */
        left: 50%;
        transform: translateX(-50%);
        /* Optional: Adjust the top value to position the loader vertically as desired */
        top: 50%;
      }

      @keyframes spin {
        0% {
          transform: translateX(-50%) rotate(0deg);
        }
        100% {
          transform: translateX(-50%) rotate(360deg);
        }
      }

      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Web Scraper</h1>
    <form action="/scrape" method="POST" onsubmit="showLoader()">
      <input
        type="text"
        name="url"
        placeholder="Enter URL to scrape"
        required
      />
      <button type="submit" id="scrapeButton">Scrape</button>
      <div class="loader" id="loader"></div>
      <!-- Loader element -->
    </form>
    <% if (data) { %>
    <h2>Scraped URL: <%= data.url %></h2>
    <!-- Add this line -->
    <h2>Results:</h2>
    <p><strong>Meta Title:</strong> <%= data.metaTitle %></p>
    <p><strong>Meta Description:</strong> <%= data.metaDescription %></p>
    <p><strong>Keywords:</strong> <%= data.keywords %></p>
    <h3>Page Text:</h3>
    <div><%= data.pageText %></div>
    <br />
    <h3>Links:</h3>
    <ul>
      <% data.links.forEach(link => { %>
      <li><%= link.text %> (<%= link.href %>)</li>
      <% }) %>
    </ul>
    <hr />
    <h3>Meta Tags:</h3>
    <ul>
      <% data.metaTags.forEach(metaTag => { %>
      <li><%= metaTag.name %>: <%= metaTag.content %></li>
      <% }) %>
    </ul>
    <h3>CTAs:</h3>
    <ul>
      <% data.ctas.forEach(cta => { %>
      <li><%= cta.text %> (<%= cta.href %>)</li>
      <% }) %>
    </ul>
    <br />
    <a href="/">Scrape another URL</a>
    <form action="/download" method="get">
      <button type="submit">Download as Word Doc</button>
    </form>
    <% } %>
    <script>
      function showLoader() {
        document.getElementById("loader").style.display = "inline-block"; // Show loader
        document.getElementById("scrapeButton").classList.add("hidden"); // Hide button
      }
    </script>
  </body>
</html>
